<!DOCTYPE html>
<html>
    <head>
        <title>TravelAssist</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    </head>

    <body background="lines.png">
     <nav class="navbar navbar-expand-lg navbar-light bg-light">
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo01" aria-controls="navbarTogglerDemo01" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>
  <div class="collapse navbar-collapse" id="navbarTogglerDemo01">
    <a class="navbar-brand" href="https://www.linkedin.com/in/ivan-pasciucco-2624a614b/">Ivan Pasciucco </a>
    <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
      <li class="nav-item active">
        <a class="nav-link" href="index.html">Home <span class="sr-only">(current)</span></a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="maqueta.html">Curriculum</a>
      </li>
      
    </ul>
    <form class="form-inline my-2 my-lg-0">

    </form>
  </div>
</nav>

      <form>
        <div class="form-group">
      <h1>Formulario </h1>
       
    <fieldset>
      <legend>FORMULARIO DE INSCRIPCION </legend> 
               <p> Nombre:  <input type="text" name="nombre" id="nombre" class="form-control"></p>
               <p> Apellido:  <input type="text" name="apellido" id="apellido"   ></p>
                <p> Edad:  <input type="number" name="edad" id="edad" class="form-control"> </p>
              	 
       
              <input type="button" id="adicionar" onclick="addHtmlTableRow()" class="btn btn-success" value="Enviar" > 
              </fieldset>
            </div>
        </form>
        <input type="button" onclick="tableToExcel('mytable', 'tabla de ivan')" value="Export to Excel"> 

       <br>
  <h1>RESULTADOS</h1>

      <table  id="mytable" class="table ">
                    <tr>
                        <th>Nombre</th>
                        <th>Apellido</th>
                        <th>Edad</th>
                        
                    </tr>
                </table>
                <p id="alerta">
            </div>



  <script>
function addHtmlTableRow(){
  
  var nombre = document.getElementById("nombre").value;
  var apellido = document.getElementById("apellido").value;
  var edad = document.getElementById("edad").value;
  


  var table = document.getElementById("mytable");
  var row = table.insertRow(-1);
  var cell1 = row.insertCell(0);
  var cell2 = row.insertCell(1);
  var cell3 = row.insertCell(2);
  var cell4 = row.insertCell(3);
 
  cell1.innerHTML = nombre;
  cell2.innerHTML = apellido;
  cell3.innerHTML = edad;
 
  cell4.innerHTML = '<button type="button" name="remove" onclick="borrar(this)" class="btn btn-danger btn_remove">Quitar</button>';
}

function borrar(r) {
  var i = r.parentNode.parentNode.rowIndex;
  document.getElementById("mytable").deleteRow(i);
}
var tableToExcel = (function() {
     var uri = 'data:application/vnd.ms-excel;base64,',
       template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>',
       base64 = function(s) {
         return window.btoa(unescape(encodeURIComponent(s)))
       },
       format = function(s, c) {
         return s.replace(/{(\w+)}/g, function(m, p) {
           return c[p];
         })
       }
     return function(table, name) {
     	var size = document.getElementById(table).rows.length;
     	if (size >1){
          if (!table.nodeType) table = document.getElementById(table)
       var ctx = {
         worksheet: name || 'Worksheet',
         table: table.innerHTML
       }
       window.location.href = uri + base64(format(template, ctx))
     }else{
     document.getElementById("alert").innerHTML ='<div class="alert alert-danger" role="alert">debe ingresar al menos un elemento </div>'
     }
 }
   })()

      </script>
      
    </body>
</html>
